# 💡브라우저 렌더링 과정

> `렌더링이란?`

HTML, CSS, 자바스크립트 등 개발자가 작성한 문서가 브라우저에서 출력되는 과정을 의미한다.
브라우저는 렌더링을 수행하는 렌더링 엔진을 가지고 있다. 크롬은 블링크, 사파리는 웹킷, 그리고 파이어 폭스는 게코라는 렌더링 엔진을 사용한다.

<br/>

> `렌더링 과정`

1. 사용자가 브라우저를 통해서 웹 사이트에 접속하면, 브라우저는 HTML, CSS, 자바스크립트, 이미지, 등등 렌더링에 필요한 리소스를 서버에 요청하고 응답을 받는다.
2. 그런 다음 서버로부터 응답받은 HTML과 CSS를 파싱하여 DOM과 CSSOM을 생성하고, 이 둘을 결합하여 렌더트리를 생성합니다.
3. 파싱 중 스크립트 태그를 만나면 브라우저의 자바스크립트 엔진은 서버로부터 응답받은 자바스크립트를 파싱합니다 이때, 만약 자바스크립트가 DOM API를 통해 DOM이나 CSSOM의 요소들을 변경한다면, 변경된 DOM과 CSSOM은 다시 렌더트리로 결합된다.
4. 마지막으로 결합된 렌더트리를 기반으로 HTML요소의 레이아웃을 계산하는 레이아웃 단계를 거치고,요소들을 화면에 그리는 페인팅 단계를 거쳐 화면에 실제로 보여지게 됩니다.

<br/>

> `DOM, CSSOM 생성과정`

HTML문서를 파싱하고 그 결과물인 DOM과 CSSOM을 만들기 위해서는 변환, 토큰화, 렉싱과정을 거치게 됩니다. DOM은 화면에 필요한 종합적인 파일들을 위주로 생성하고 CSSOM은 화면에 그려지는 스타일에 관련한 요소를 위주로 생성한다

1. `변환` : 브라우저가 HTML의 원시 바이트를 읽어와서, HTML에 정의된 인코딩(예: UTF-8)방식에 따라 개별 문자로 변환한다
2. `토큰화` : 브라우저가 변환한 문자열을 W3C(웹) 표준에 지정된 고유 토큰으로 변환합니다.
3. `렉싱` :토큰화를 통해 생성된 토큰은 해당 의미를 갖는 “객체”로 변환됩니다.
4. `DOM 생성` : 마지막으로 HTML 마크업에 정의된 여러 태그 간의 관계를 해석해서 트리 구조로 연결이 되면서 DOM과 CSSOM이 생성된다.

<br/>

> `자바스크립트 파싱`

자바스크립트의 파싱은 CSS파싱과 마찬가지로 렌더링 엔진이 HTML 문서를 한줄 씩 읽어나가다 script태그를 만나면 자바스크립트 엔진에 제어권을 넘기며 시작됩니다.

1. 자바스크립트 엔진은 CPU가 이해할 수 있는 저수준 언어로 자바스크립트 코드를 파싱하고
2. DOM, CSSOM과 같은 트리를 생성하며
3. 생성된 트리 기반으로 바이트코드를 생성하여 인터프리터가 실행될 수 있도록 만듭니다.

<br/>

> **`리플로우(Reflow), 리페인트(Repaint)`**

자바스크립트 코드가 실행되는 과정에서 DOM과 CSSOM을 변경하는 DOM API가 사용되면 변경된 DOM과 CSSOM이 다시 렌더트리로 결합되고 레이아웃과 페인트 과정을 거쳐 다시 렌더링 됩니다. 이 과정을 리플로우(reflow), 리페인트(repaint)라고 합니다.

- `리플로우`는 레이아웃을 다시 계산하는 것
- `리페인트`는 재결합된 렌더트리를 기반으로 다시 페인트하는 것

리플로우는 요소의 추가/삭제, 요소의 크기/위치 변경 등등 레이아웃에 영향을 주는 경우에만 실행된다.

리페인트는 레이아웃의 변화가 없는 배경색상, 폰트 색상, border 스타일 변경에 영향을 주었을 때 실행이 됩니다.

<br/>

# 🔗 Reference

- [https://medium.com/개발자의품격/브라우저의-렌더링-과정-5c01c4158ce](https://medium.com/%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%9D%98%ED%92%88%EA%B2%A9/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9D%98-%EB%A0%8C%EB%8D%94%EB%A7%81-%EA%B3%BC%EC%A0%95-5c01c4158ce)
- [https://devcecy.com/브라우저는-어떻게-렌더링-될까/](https://devcecy.com/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%A0%8C%EB%8D%94%EB%A7%81-%EB%90%A0%EA%B9%8C/)
